<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>10-Team PPR Mock Draft — Teams 1 & 8 Controlled</title>
<style>
  :root {
    --bg: #071226;
    --card: #0d1622;
    --muted: #9aa4b2;
    --accent: #06b6d4;
    --glass: rgba(255, 255, 255, 0.03);
  }
  * {
    box-sizing: border-box;
  }
  body {
    margin: 0;
    font-family: Inter, system-ui, Arial, sans-serif;
    background: linear-gradient(180deg, #041026, var(--bg));
    color: #e6eef6;
  }
  header {
    padding: 18px 22px;
    border-bottom: 1px solid rgba(255, 255, 255, 0.03);
    display: flex;
    align-items: center;
    justify-content: space-between;
    background: var(--card);
  }
  header h1 {
    font-size: 20px;
    margin: 0;
  }
  .container {
    max-width: 1400px;
    margin: 18px auto;
    padding: 12px 18px 40px;
    display: grid;
    grid-template-columns: 3fr 1.3fr;
    gap: 18px;
  }
  /* Left panel */
  .left-panel {
    display: flex;
    flex-direction: column;
    gap: 20px;
  }
  .controls {
    display: flex;
    gap: 12px;
    align-items: center;
  }
  button {
    background: var(--accent);
    border: 0;
    padding: 10px 16px;
    border-radius: 8px;
    color: #042;
    font-weight: 700;
    cursor: pointer;
    user-select: none;
    transition: background-color 0.25s ease;
  }
  button.secondary {
    background: transparent;
    border: 1px solid rgba(255, 255, 255, 0.06);
    color: var(--muted);
  }
  button:disabled {
    background-color: rgba(6, 182, 212, 0.4);
    cursor: default;
  }
  input[type=range] {
    width: 160px;
  }
  .topbar {
    display: flex;
    gap: 12px;
    align-items: center;
  }
  input#search {
    flex: 1;
    padding: 8px;
    border-radius: 8px;
    border: 1px solid rgba(255, 255, 255, 0.04);
    background: transparent;
    color: inherit;
    font-size: 15px;
  }
  select#positionFilter {
    background: var(--card);
    color: var(--muted);
    border: none;
    padding: 8px 12px;
    border-radius: 8px;
    font-size: 15px;
    cursor: pointer;
  }
  .status-pill {
    color: var(--muted);
    font-size: 14px;
    min-width: 130px;
    text-align: center;
  }
  #timer {
    font-weight: 700;
    color: var(--accent);
    min-width: 90px;
    text-align: center;
  }

  /* Draft board */
  #boardContainer {
    display: grid;
    gap: 6px;
    overflow-x: auto;
  }
  .board-row {
    display: grid;
    grid-template-columns: repeat(12, 1fr);
    gap: 6px;
  }
  .slot {
    background: var(--glass);
    padding: 6px 8px;
    border-radius: 8px;
    font-size: 12px;
    min-height: 56px;
    display: flex;
    flex-direction: column;
    justify-content: center;
    user-select: none;
  }
  .slot.empty {
    opacity: 0.4;
  }
  .slot .team {
    font-weight: 700;
    font-size: 11px;
    color: var(--muted);
  }
  .slot .player {
    margin-top: 4px;
    font-weight: 600;
  }
  /* Available players */
  #available {
    max-height: 380px;
    overflow-y: auto;
    padding: 6px;
    border-radius: 8px;
    background: rgba(0, 0, 0, 0.12);
  }
  .player-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 8px 12px;
    border-radius: 8px;
    margin-bottom: 6px;
    background: linear-gradient(90deg, rgba(255, 255, 255, 0.02), rgba(255, 255, 255, 0));
    font-size: 14px;
  }
  .player-row:hover {
    background: rgba(6, 182, 212, 0.2);
  }
  .player-meta {
    font-size: 13px;
    color: var(--muted);
  }
  .player-row > div:first-child {
    flex: 1 1 auto;
  }
  .player-row button {
    flex-shrink: 0;
    font-size: 13px;
    padding: 6px 10px;
    background: var(--accent);
    color: #042;
    font-weight: 700;
    border-radius: 6px;
    border: none;
    cursor: pointer;
  }
  .player-row button:disabled {
    background: rgba(6, 182, 212, 0.3);
    cursor: default;
  }
  /* Right panel */
  .right-panel {
    background: var(--card);
    padding: 16px 18px;
    border-radius: 14px;
    display: flex;
    flex-direction: column;
    gap: 20px;
    max-height: 900px;
  }
  .roster-selector {
    display: flex;
    align-items: center;
    gap: 12px;
    margin-bottom: 6px;
  }
  select#rosterTeamSelect {
    flex: 1;
    background: var(--bg);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 8px;
    color: var(--muted);
    padding: 8px 12px;
    font-size: 16px;
    cursor: pointer;
  }
  h3.roster-title {
    margin: 6px 0 12px;
    font-size: 18px;
    text-align: center;
  }
  .roster-list {
    list-style: none;
    padding-left: 12px;
    max-height: 580px;
    overflow-y: auto;
    font-size: 14px;
  }
  .roster-list li {
    margin-bottom: 6px;
  }
  .roster-list strong {
    width: 65px;
    display: inline-block;
  }
  /* Log */
  #log {
    font-family: monospace;
    font-size: 13px;
    max-height: 150px;
    overflow-y: auto;
    padding: 8px;
    background: rgba(0, 0, 0, 0.18);
    border-radius: 8px;
    white-space: pre-wrap;
  }

  /* Responsive */
  @media (max-width: 1300px) {
    .container {
      grid-template-columns: 1fr 1fr;
    }
  }
  @media (max-width: 900px) {
    .container {
      grid-template-columns: 1fr;
    }
    #boardContainer {
      grid-template-columns: repeat(6, 1fr);
    }
  }
</style>
</head>
<body>
<header>
  <h1>10-Team PPR Mock Draft — You control picks <strong>1 &amp; 8</strong></h1>
  <div class="status-pill" id="status">Status: Ready</div>
</header>

<div class="container">
  <div class="left-panel">
    <div class="controls">
      <button id="startBtn">Start Draft</button>
      <button id="pauseBtn" class="secondary" disabled>Pause</button>
      <button id="resetBtn" class="secondary">Reset</button>
      <label style="margin-left:auto; font-size:14px; color: var(--muted); display:flex; align-items:center; gap:6px;">
        Speed
        <input id="speed" type="range" min="200" max="1600" step="100" value="700" />
        <span id="speedValue" style="width:32px; text-align:center;">700</span> ms
      </label>
    </div>

    <div class="topbar">
      <input
        id="search"
        type="search"
        placeholder="Search players (name / pos / team)"
        autocomplete="off"
        spellcheck="false"
        aria-label="Search players"
      />
      <select id="positionFilter" aria-label="Filter players by position">
        <option value="">All Positions</option>
        <option value="QB">QB</option>
        <option value="RB">RB</option>
        <option value="WR">WR</option>
        <option value="TE">TE</option>
        <option value="K">K</option>
        <option value="DEF">DEF</option>
      </select>
      <div class="status-pill" id="roundPickDisplay">Round 0 • Pick 0</div>
      <div id="timer">Timer: --</div>
    </div>

    <h3 style="margin-bottom:8px;">Draft Board</h3>
    <div id="boardContainer" aria-live="polite" aria-label="Draft board"></div>

    <h3 style="margin-top:20px;">Available Players</h3>
    <div id="available" aria-live="polite" aria-label="Available players"></div>

    <h3 style="margin-top:20px;">Draft Log</h3>
    <div id="log" aria-live="polite" aria-atomic="true"></div>
  </div>

  <aside class="right-panel" aria-label="Rosters and team controls">
    <div class="roster-selector">
      <label for="rosterTeamSelect" style="color:var(--muted); font-weight:700;">View Team Roster:</label>
      <select id="rosterTeamSelect" aria-label="Select team roster to view"></select>
    </div>
    <h3 class="roster-title" id="rosterTeamTitle">Team 1 Roster</h3>
    <ul class="roster-list" id="rosterList" role="list"></ul>
  </aside>
</div>

<script>
(() => {
  // CONFIG
  const TEAMS = 10;
  const ROUNDS = 10;
  const TOTAL_PICKS = TEAMS * ROUNDS;
  const USER_SLOTS = [1, 8]; // Teams user controls
  const USER_PICK_TIMEOUT_MS = 30000; // 30 seconds

  // POSITIONS for roster order & filtering
  const ROSTER_POSITIONS = ["QB", "RB1", "RB2", "WR1", "WR2", "TE", "FLEX", "DST", "K", "Bench"];
  const FLEX_ELIGIBLE = ["RB", "WR", "TE"];

  // USER RANKINGS (sample top ~130 players)
  // You can replace or extend this list as you want
  const USER_RANKINGS = [
    { name: "Ja'Marr Chase", pos: "WR", team: "Bengals" },
    { name: "Justin Jefferson", pos: "WR", team: "Vikings" },
    { name: "Bijan Robinson", pos: "RB", team: "Falcons" },
    { name: "Puka Nacua", pos: "WR", team: "Rams" },
    { name: "Saquon Barkley", pos: "RB", team: "Eagles" },
    { name: "CeeDee Lamb", pos: "WR", team: "Cowboys" },
    { name: "Amon-Ra St. Brown", pos: "WR", team: "Lions" },
    { name: "Jahmyr Gibbs", pos: "RB", team: "Lions" },
    { name: "Ashton Jeanty", pos: "RB", team: "Rookie" },
    { name: "Brian Thomas Jr.", pos: "WR", team: "Jaguars" },
    { name: "Nico Collins", pos: "WR", team: "Texans" },
    { name: "Brock Bowers", pos: "TE", team: "Raiders" },
    { name: "Malik Nabers", pos: "WR", team: "Giants" },
    { name: "De'Von Achane", pos: "RB", team: "Dolphins" },
    { name: "Trey McBride", pos: "TE", team: "Cardinals" },
    { name: "A.J. Brown", pos: "WR", team: "Eagles" },
    { name: "Bucky Irving", pos: "RB", team: "Buccaneers" },
    { name: "Josh Allen", pos: "QB", team: "Bills" },
    { name: "Lamar Jackson", pos: "QB", team: "Ravens" },
    { name: "Drake London", pos: "WR", team: "Falcons" },
    { name: "Christian McCaffrey", pos: "RB", team: "49ers" },
    { name: "Derrick Henry", pos: "RB", team: "Ravens" },
    { name: "Josh Jacobs", pos: "RB", team: "Packers" },
    { name: "Omarion Hampton", pos: "RB", team: "Rookie" },
    { name: "Tee Higgins", pos: "WR", team: "Bengals" },
    { name: "Jayden Daniels", pos: "QB", team: "Commanders" },
    { name: "Ladd McConkey", pos: "WR", team: "Chargers" },
    { name: "Jonathan Taylor", pos: "RB", team: "Colts" },
    { name: "Kyren Williams", pos: "RB", team: "Rams" },
    { name: "Kenneth Walker III", pos: "RB", team: "Seahawks" },
    { name: "Garrett Wilson", pos: "WR", team: "Jets" },
    { name: "Jalen Hurts", pos: "QB", team: "Eagles" },
    { name: "George Kittle", pos: "TE", team: "49ers" },
    { name: "Tyreek Hill", pos: "WR", team: "Dolphins" },
    { name: "Terry McLaurin", pos: "WR", team: "Commanders" },
    { name: "Joe Mixon", pos: "RB", team: "Texans" },
    { name: "James Cook", pos: "RB", team: "Bills" },
    { name: "Breece Hall", pos: "RB", team: "Jets" },
    { name: "Chase Brown", pos: "RB", team: "Bengals" },
    { name: "Alvin Kamara", pos: "RB", team: "Saints" },
    { name: "Davante Adams", pos: "WR", team: "Rams" },
    { name: "Chuba Hubbard", pos: "RB", team: "Panthers" },
    { name: "Jaxon Smith-Njigba", pos: "WR", team: "Seahawks" },
    { name: "D.J. Moore", pos: "WR", team: "Bears" },
    { name: "Mike Evans", pos: "WR", team: "Buccaneers" },
    { name: "Chris Godwin", pos: "WR", team: "Buccaneers" },
    { name: "TreVeyon Henderson", pos: "RB", team: "Rookie" },
    { name: "James Conner", pos: "RB", team: "Cardinals" },
    { name: "Rashee Rice", pos: "WR", team: "Chiefs" },
    { name: "Quinshon Judkins", pos: "RB", team: "Rookie" },
    { name: "Kaleb Johnson", pos: "RB", team: "Rookie" },
    { name: "Cam Skattebo", pos: "RB", team: "Rookie" },
    { name: "Marvin Harrison Jr.", pos: "WR", team: "Cardinals" },
    { name: "DeVonta Smith", pos: "WR", team: "Eagles" },
    { name: "Tetairoa McMillan", pos: "WR", team: "Rookie" },
    { name: "Xavier Worthy", pos: "WR", team: "Chiefs" },
    { name: "Zay Flowers", pos: "WR", team: "Ravens" },
    { name: "Joe Burrow", pos: "QB", team: "Bengals" },
    { name: "Chris Olave", pos: "WR", team: "Saints" },
    { name: "Sam LaPorta", pos: "TE", team: "Lions" },
    { name: "Courtland Sutton", pos: "WR", team: "Broncos" },
    { name: "Jared Goff", pos: "QB", team: "Jaguars" },
    { name: "Zach Ertz", pos: "TE", team: "Cardinals" },
    { name: "Tyler Linderbaum", pos: "C", team: "Colts" },
    { name: "Kenny Pickett", pos: "QB", team: "Steelers" },
    { name: "Khalil Herbert", pos: "RB", team: "Bears" },
    { name: "Alexander Mattison", pos: "RB", team: "Vikings" },
    { name: "Jalen Tolbert", pos: "WR", team: "Cowboys" },
    { name: "D'Onta Foreman", pos: "RB", team: "Saints" },
    { name: "Michael Thomas", pos: "WR", team: "Saints" },
    { name: "Adam Thielen", pos: "WR", team: "Panthers" },
    { name: "Mike Williams", pos: "WR", team: "Chargers" },
    { name: "Alec Pierce", pos: "WR", team: "Colts" },
    { name: "Jahan Dotson", pos: "WR", team: "Commanders" },
    { name: "Dallas Goedert", pos: "TE", team: "Eagles" },
    { name: "Hunter Henry", pos: "TE", team: "Patriots" },
    { name: "Jordan Addison", pos: "WR", team: "Vikings" },
    { name: "Rashid Shaheed", pos: "WR", team: "Saints" },
    { name: "Dalton Kincaid", pos: "TE", team: "Bills" },
    { name: "Sammy Watkins", pos: "WR", team: "Chiefs" },
    { name: "Jared Cook", pos: "TE", team: "Patriots" },
    { name: "Tyler Allgeier", pos: "RB", team: "Falcons" },
  ];

  // TEAMS array (names)
  const TEAM_NAMES = [
    "Team 1 (You)",
    "Team 2",
    "Team 3",
    "Team 4",
    "Team 5",
    "Team 6",
    "Team 7",
    "Team 8 (You)",
    "Team 9",
    "Team 10",
  ];

  // DRAFT STATE
  let draftStarted = false;
  let draftPaused = false;
  let currentPick = 1; // 1 to 120 (10 teams * 10 rounds)
  let pickOrder = [];
  let round = 1;
  let pickInRound = 1;
  let currentTeam = 1;
  let timerId = null;
  let timerSecondsLeft = USER_PICK_TIMEOUT_MS / 1000;
  let draftLog = [];
  let availablePlayers = [...USER_RANKINGS];
  let teamsRoster = new Array(TEAMS + 1).fill(null).map(() => ({
    picks: [],
  }));

  // UTILITIES
  function serpentineOrder() {
    // Returns array of team picks for 10 rounds serpentine
    let order = [];
    for (let r = 1; r <= ROUNDS; r++) {
      let roundOrder = [];
      if (r % 2 === 1) {
        for (let t = 1; t <= TEAMS; t++) roundOrder.push(t);
      } else {
        for (let t = TEAMS; t >= 1; t--) roundOrder.push(t);
      }
      order.push(roundOrder);
    }
    return order.flat();
  }

  function teamName(tNum) {
    return TEAM_NAMES[tNum - 1] || "Unknown";
  }

  // Find player index in availablePlayers by exact name match
  function findPlayerIndex(name) {
    return availablePlayers.findIndex(p => p.name === name);
  }

  // Pick a player for team, remove from available, add to roster picks, update board, log
  function pickPlayer(team, player) {
    // Defensive: ignore if player not available
    const idx = findPlayerIndex(player.name);
    if (idx === -1) {
      logEvent(`Player ${player.name} not available.`);
      return false;
    }
    availablePlayers.splice(idx, 1);
    teamsRoster[team].picks.push(player);
    updateBoard(currentPick, team, player);
    logEvent(`${teamName(team)} picked ${player.name} (${player.pos})`);
    return true;
  }

  // Update the draft board UI at pick number with pick details
  function updateBoard(pickNum, team, player) {
    const slotId = `pick-${pickNum}`;
    const slot = document.getElementById(slotId);
    if (!slot) return;
    slot.classList.remove("empty");
    slot.innerHTML = `<div class="team">${teamName(team)}</div><div class="player">${player.name} (${player.pos})</div>`;
  }

  // Log event text to draft log box
  function logEvent(text) {
    draftLog.push(text);
    const logEl = document.getElementById("log");
    if (!logEl) return;
    logEl.textContent = draftLog.join("\n");
    logEl.scrollTop = logEl.scrollHeight;
  }

  // Initialize draft board UI
  function initBoard() {
    const board = document.getElementById("boardContainer");
    board.innerHTML = "";
    for (let r = 1; r <= ROUNDS; r++) {
      const row = document.createElement("div");
      row.classList.add("board-row");
      // Round label
      const roundLabel = document.createElement("div");
      roundLabel.classList.add("slot");
      roundLabel.style.fontWeight = "700";
      roundLabel.style.background = "var(--card)";
      roundLabel.textContent = "Rnd " + r;
      row.appendChild(roundLabel);

      // Picks for 10 teams in serpentine order
      let teamsOrder = r % 2 === 1
        ? [...Array(TEAMS).keys()].map(i => i + 1)
        : [...Array(TEAMS).keys()].map(i => TEAMS - i);
      for (let t = 0; t < TEAMS; t++) {
        const slot = document.createElement("div");
        slot.classList.add("slot", "empty");
        const pickNum = (r - 1) * TEAMS + (t + 1);
        slot.id = `pick-${pickNum}`;
        slot.dataset.pickNum = pickNum;
        slot.textContent = "Pick " + pickNum;
        row.appendChild(slot);
      }
      board.appendChild(row);
    }
  }

  // Initialize roster team select dropdown
  function initRosterSelect() {
    const select = document.getElementById("rosterTeamSelect");
    select.innerHTML = "";
    for (let i = 1; i <= TEAMS; i++) {
      const opt = document.createElement("option");
      opt.value = i;
      opt.textContent = teamName(i);
      select.appendChild(opt);
    }
    select.value = USER_SLOTS[0];
    updateRosterView(USER_SLOTS[0]);
  }

  // Update roster view for team number
  function updateRosterView(team) {
    const title = document.getElementById("rosterTeamTitle");
    const list = document.getElementById("rosterList");
    title.textContent = `${teamName(team)} Roster`;
    list.innerHTML = "";

    // Compose roster spots with ordering
    // QB, RB1, RB2, WR1, WR2, TE, FLEX, DST, K, Bench (bench is leftover)
    const rosterPlayers = teamsRoster[team].picks || [];
    // Prepare counts
    let qb = null, rb = [], wr = [], te = null, dst = null, k = null;
    let bench = [];

    // Fill starters with first available players at positions
    for (const p of rosterPlayers) {
      if (p.pos === "QB" && !qb) qb = p;
      else if (p.pos === "RB" && rb.length < 2) rb.push(p);
      else if (p.pos === "WR" && wr.length < 2) wr.push(p);
      else if (p.pos === "TE" && !te) te = p;
      else if (p.pos === "DEF" && !dst) dst = p;
      else if (p.pos === "K" && !k) k = p;
      else bench.push(p);
    }
    // FLEX spot: first RB/WR/TE left after starters
    const flexCandidates = bench.filter(p => FLEX_ELIGIBLE.includes(p.pos));
    let flex = null;
    if (flexCandidates.length > 0) {
      flex = flexCandidates[0];
      bench.splice(bench.indexOf(flex), 1);
    }

    function playerLine(name, pos) {
      return `<li><strong>${pos}:</strong> ${name}</li>`;
    }

    if (qb) list.insertAdjacentHTML("beforeend", playerLine(qb.name, "QB"));
    else list.insertAdjacentHTML("beforeend", "<li><strong>QB:</strong> —</li>");

    if (rb[0]) list.insertAdjacentHTML("beforeend", playerLine(rb[0].name, "RB1"));
    else list.insertAdjacentHTML("beforeend", "<li><strong>RB1:</strong> —</li>");

    if (rb[1]) list.insertAdjacentHTML("beforeend", playerLine(rb[1].name, "RB2"));
    else list.insertAdjacentHTML("beforeend", "<li><strong>RB2:</strong> —</li>");

    if (wr[0]) list.insertAdjacentHTML("beforeend", playerLine(wr[0].name, "WR1"));
    else list.insertAdjacentHTML("beforeend", "<li><strong>WR1:</strong> —</li>");

    if (wr[1]) list.insertAdjacentHTML("beforeend", playerLine(wr[1].name, "WR2"));
    else list.insertAdjacentHTML("beforeend", "<li><strong>WR2:</strong> —</li>");

    if (te) list.insertAdjacentHTML("beforeend", playerLine(te.name, "TE"));
    else list.insertAdjacentHTML("beforeend", "<li><strong>TE:</strong> —</li>");

    if (flex) list.insertAdjacentHTML("beforeend", playerLine(flex.name, "FLEX"));
    else list.insertAdjacentHTML("beforeend", "<li><strong>FLEX:</strong> —</li>");

    if (dst) list.insertAdjacentHTML("beforeend", playerLine(dst.name, "DST"));
    else list.insertAdjacentHTML("beforeend", "<li><strong>DST:</strong> —</li>");

    if (k) list.insertAdjacentHTML("beforeend", playerLine(k.name, "K"));
    else list.insertAdjacentHTML("beforeend", "<li><strong>K:</strong> —</li>");

    if (bench.length > 0) {
      list.insertAdjacentHTML("beforeend", "<li><strong>Bench:</strong></li>");
      bench.forEach(p => {
        list.insertAdjacentHTML("beforeend", `<li>&nbsp;&nbsp;&nbsp;${p.name} (${p.pos})</li>`);
      });
    }
  }

  // Update the available players display based on filters/search
  function updateAvailablePlayers() {
    const container = document.getElementById("available");
    const posFilter = document.getElementById("positionFilter").value.trim();
    const searchTerm = document.getElementById("search").value.trim().toLowerCase();

    container.innerHTML = "";

    let filtered = availablePlayers.filter(p => {
      if (posFilter && p.pos !== posFilter) return false;
      if (
        !(
          p.name.toLowerCase().includes(searchTerm) ||
          p.pos.toLowerCase().includes(searchTerm) ||
          p.team.toLowerCase().includes(searchTerm)
        )
      )
        return false;
      return true;
    });

    if (filtered.length === 0) {
      container.innerHTML = "<div style='padding:12px; text-align:center; color:var(--muted);'>No players found.</div>";
      return;
    }

    filtered.forEach(p => {
      const row = document.createElement("div");
      row.className = "player-row";

      const info = document.createElement("div");
      info.innerHTML = `<strong>${p.name}</strong> (${p.pos}) — ${p.team}`;
      info.setAttribute("title", `${p.name} (${p.pos}) — ${p.team}`);

      const btn = document.createElement("button");
      btn.textContent = "Pick";
      btn.disabled = !canPick(); // Only enabled if current pick belongs to user
      btn.addEventListener("click", () => {
        if (!canPick()) return;
        makePick(p);
      });

      row.appendChild(info);
      row.appendChild(btn);
      container.appendChild(row);
    });
  }

  // Can the user pick right now?
  function canPick() {
    return draftStarted && !draftPaused && USER_SLOTS.includes(currentTeam);
  }

  // Start timer for user pick
  function startTimer() {
    clearInterval(timerId);
    timerSecondsLeft = USER_PICK_TIMEOUT_MS / 1000;
    updateTimerUI();

    timerId = setInterval(() => {
      if (timerSecondsLeft <= 0) {
        clearInterval(timerId);
        logEvent(`Time expired for ${teamName(currentTeam)}. Auto-picking...`);
        autoPickForUserTeam();
        return;
      }
      timerSecondsLeft--;
      updateTimerUI();
    }, 1000);
  }

  function updateTimerUI() {
    const timerEl = document.getElementById("timer");
    timerEl.textContent = canPick() ? `Timer: ${timerSecondsLeft}s` : "Timer: --";
  }

  // Auto-pick for user team on timer expire
  function autoPickForUserTeam() {
    if (!canPick()) return;

    // Pick top available player (best by ranking)
    if (availablePlayers.length === 0) return;

    makePick(availablePlayers[0]);
  }

  // Make a pick for current team
  function makePick(player) {
    if (!draftStarted || draftPaused) return;
    if (!canPick() && !USER_SLOTS.includes(currentTeam)) return;

    // Assign player
    if (!pickPlayer(currentTeam, player)) return;

    // Move to next pick
    advancePick();
  }

  // Advance draft pick and trigger next pick or finish draft
  function advancePick() {
    clearInterval(timerId);

    currentPick++;
    if (currentPick > TOTAL_PICKS) {
      // Draft complete
      draftStarted = false;
      setStatus("Draft completed!");
      document.getElementById("timer").textContent = "Timer: --";
      updateAvailablePlayers();
      return;
    }

    round = Math.ceil(currentPick / TEAMS);
    pickInRound = ((currentPick - 1) % TEAMS) + 1;

    // Determine team for this pick (serpentine)
    const isOddRound = round % 2 === 1;
    if (isOddRound) {
      currentTeam = pickInRound;
    } else {
      currentTeam = TEAMS - pickInRound + 1;
    }

    setStatus(`Round ${round} • Pick ${pickInRound} (${teamName(currentTeam)})`);

    updateRoundPickUI();

    if (USER_SLOTS.includes(currentTeam)) {
      // User's turn - start timer and enable UI
      updateAvailablePlayers();
      startTimer();
    } else {
      // Bot pick after short delay affected by speed slider
      updateAvailablePlayers();
      timerSecondsLeft = 0;
      setTimeout(() => {
        botAutoPick();
      }, +document.getElementById("speed").value);
    }

    updateRosterView(currentTeam);
  }

  // Bot auto-pick logic (just pick top available player)
  function botAutoPick() {
    if (!draftStarted || draftPaused) return;
    if (USER_SLOTS.includes(currentTeam)) return; // Shouldn't happen

    if (availablePlayers.length === 0) {
      advancePick();
      return;
    }

    // Pick top available player
    pickPlayer(currentTeam, availablePlayers[0]);

    advancePick();
  }

  // Set status message in header
  function setStatus(text) {
    document.getElementById("status").textContent = "Status: " + text;
  }

  // Update round and pick display UI
  function updateRoundPickUI() {
    const el = document.getElementById("roundPickDisplay");
    el.textContent = `Round ${round} • Pick ${pickInRound}`;
  }

  // Reset draft state
  function resetDraft() {
    draftStarted = false;
    draftPaused = false;
    currentPick = 1;
    round = 1;
    pickInRound = 1;
    currentTeam = 1;
    clearInterval(timerId);
    timerSecondsLeft = USER_PICK_TIMEOUT_MS / 1000;
    draftLog = [];
    availablePlayers = [...USER_RANKINGS];
    teamsRoster = new Array(TEAMS + 1).fill(null).map(() => ({
      picks: [],
    }));

    // Reset UI
    initBoard();
    initRosterSelect();
    updateRoundPickUI();
    setStatus("Ready");
    updateTimerUI();
    updateAvailablePlayers();
    document.getElementById("pauseBtn").disabled = true;
  }

  // Pause and resume draft
  function togglePause() {
    draftPaused = !draftPaused;
    if (draftPaused) {
      setStatus("Paused");
      clearInterval(timerId);
    } else {
      setStatus(`Round ${round} • Pick ${pickInRound} (${teamName(currentTeam)})`);
      if (USER_SLOTS.includes(currentTeam)) {
        startTimer();
      } else {
        setTimeout(botAutoPick, +document.getElementById("speed").value);
      }
    }
    document.getElementById("pauseBtn").textContent = draftPaused ? "Resume" : "Pause";
  }

  // Handle roster team selector change
  document.getElementById("rosterTeamSelect").addEventListener("change", e => {
    const val = parseInt(e.target.value, 10);
    updateRosterView(val);
  });

  // Handle search and filter changes
  document.getElementById("positionFilter").addEventListener("change", updateAvailablePlayers);
  document.getElementById("search").addEventListener("input", updateAvailablePlayers);

  // Start/pause/reset button handlers
  document.getElementById("startBtn").addEventListener("click", () => {
    if (draftStarted) return;
    draftStarted = true;
    draftPaused = false;
    setStatus(`Round 1 • Pick 1 (${teamName(1)})`);
    updateRoundPickUI();
    updateAvailablePlayers();
    startTimer();
    document.getElementById("pauseBtn").disabled = false;
  });

  document.getElementById("pauseBtn").addEventListener("click", () => {
    togglePause();
  });

  document.getElementById("resetBtn").addEventListener("click", () => {
    if (confirm("Are you sure you want to reset the draft? All progress will be lost.")) {
      resetDraft();
    }
  });

  // Initialize UI and board on page load
  resetDraft();
})();
</script>
</body>
</html>
